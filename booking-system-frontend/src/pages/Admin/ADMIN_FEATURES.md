# 管理员后台功能说明

## 概述

管理员后台提供了完整的后台管理功能，包括数据总览、改签退票管理、车次管理和票价管理。

## 功能模块

### 1. 数据总览

展示系统的关键统计数据：
- **今日订单数**：当日产生的订单总数
- **今日售票量**：当日售出的车票总数
- **车次数量**：系统中所有车次的总数
- **用户数量**：注册用户的总数

### 2. 改签退票管理

管理用户提交的改签和退票申请。

#### 功能特性
- **列表查看**：查看所有改签退票请求
- **分类筛选**：按类型（退票/改签）和状态（待审核/已通过/已拒绝）筛选
- **详情查看**：查看申请的详细信息
- **审核操作**：
  - 通过申请
  - 拒绝申请（需填写拒绝原因）

#### 数据字段
- 订单号
- 申请类型（退票/改签）
- 乘客姓名
- 车次信息
- 出发时间
- 金额（退款金额/改签费用）
- 申请原因
- 审核状态
- 申请时间/处理时间

### 3. 车次管理

管理系统中的所有车次信息。

#### 功能特性
- **查看列表**：分页查看所有车次
- **添加车次**：添加新的车次
- **编辑车次**：修改现有车次信息
- **删除车次**：删除不再使用的车次

#### 车次信息
- **基本信息**：
  - 车次号（如：G101）
  - 列车类型（高铁/动车/普速）
  - 出发站
  - 到达站
  - 出发时间
  - 到达时间
  - 历时
  - 日期

- **座位信息**（每种座位类型包含）：
  - 商务座（可选）
  - 一等座
  - 二等座
  
  每种座位类型包括：
  - 可用座位数
  - 总座位数
  - 价格

### 4. 票价管理

专门用于管理车次的票价信息。

#### 功能特性
- **查看票价**：查看所有车次的票价信息
- **修改票价**：快速修改各座位等级的票价
- **实时生效**：票价修改后立即生效

#### 票价类型
- **商务座**：最高等级座位（可选）
- **一等座**：中等级座位（必填）
- **二等座**：普通座位（必填）

## API接口

所有接口已在Mock模式下实现，可直接测试使用。

### 统计数据
- `GET /admin/stats` - 获取统计数据

### 改签退票
- `GET /admin/refund-change/list` - 获取改签退票请求列表
- `POST /admin/refund-change/:id/process` - 审核改签退票请求

### 车次管理
- `GET /admin/trips` - 获取车次管理列表
- `POST /admin/trips` - 添加车次
- `PUT /admin/trips/:id` - 更新车次
- `DELETE /admin/trips/:id` - 删除车次

### 票价管理
- `PUT /admin/trips/:id/price` - 更新票价

## 使用说明

### 访问管理后台

1. 启动项目：`npm run dev`
2. 登录系统（Mock模式下任意用户名密码均可）
3. 访问管理后台：导航至 `/admin` 路径

### 导航使用

管理后台采用侧边栏导航设计：
- 点击左侧菜单项切换不同的管理模块
- 当前选中的菜单项会高亮显示
- 各模块之间切换不会丢失当前页面的状态

### 操作流程

#### 审核改签退票
1. 进入"改签退票管理"
2. 使用Tab切换查看不同类型的申请
3. 点击"详情"查看完整信息
4. 点击"通过"或"拒绝"进行审核
5. 如需拒绝，需填写拒绝原因

#### 管理车次
1. 进入"车次管理"
2. 点击"添加车次"按钮
3. 填写完整的车次信息
4. 至少需要设置一等座和二等座信息
5. 商务座为可选项
6. 保存后即可在列表中看到

#### 修改票价
1. 进入"票价管理"
2. 找到需要修改的车次
3. 点击"修改票价"按钮
4. 调整各座位等级的价格
5. 确认后票价立即生效

## 技术实现

### 组件结构
```
Admin/
├── index.jsx              # 主页面，包含侧边栏和路由切换
├── RefundChangeManagement.jsx  # 改签退票管理
├── TripManagement.jsx     # 车次管理
├── PriceManagement.jsx    # 票价管理
└── style.css              # 样式文件
```

### 技术栈
- **React** - UI框架
- **Ant Design** - UI组件库
- **Axios** - HTTP客户端
- **Dayjs** - 日期处理库

### Mock数据
所有数据均在 `src/mock/` 目录下模拟：
- `data.js` - Mock数据定义
- `index.js` - API拦截器

## 注意事项

1. **Mock模式**：当前所有功能均在Mock模式下运行，数据不会持久化
2. **数据重置**：刷新页面后Mock数据会重置
3. **权限控制**：实际部署时需要在后端实现权限验证
4. **数据验证**：前端已实现基本验证，后端需要实现完整的数据验证
5. **并发控制**：实际生产环境需要考虑并发修改的问题

## 后续开发建议

1. **权限管理**：添加基于角色的权限控制
2. **数据导出**：支持导出报表和数据
3. **批量操作**：支持批量审核、批量修改等
4. **操作日志**：记录管理员的所有操作
5. **数据统计**：添加更多维度的数据分析图表
6. **消息通知**：对用户的申请结果进行消息通知
